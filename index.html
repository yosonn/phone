<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NutriAI Mobile - æ™ºæ…§ç‡Ÿé¤Šç›£æ¸¬ç³»çµ±</title>
    <style>
        :root {
            --primary: #009688; /* é†«ç™‚ç¶  */
            --primary-dark: #00796b;
            --secondary: #2196f3;
            --accent: #ff9800;
            --danger: #ef5350;
            --success: #4caf50;
            --bg: #f5f7f9;
            --surface: #ffffff;
            --text-main: #2c3e50;
            --text-sub: #7f8c8d;
            --shadow: 0 4px 15px rgba(0,0,0,0.05);
            --radius: 16px;
            --nav-height: 70px;
        }

        /* åŸºç¤æ¨£å¼ */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, "Noto Sans TC", sans-serif; }
        body { background-color: var(--bg); color: var(--text-main); padding-bottom: calc(var(--nav-height) + 20px); overflow-x: hidden; }

        /* ä»‹é¢åˆ‡æ›é‚è¼¯ */
        .screen { display: none; padding: 20px; animation: fadeIn 0.4s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* é€šç”¨å…ƒä»¶ */
        .card { background: var(--surface); border-radius: var(--radius); padding: 20px; margin-bottom: 20px; box-shadow: var(--shadow); }
        .section-title { font-size: 1.2rem; font-weight: 800; margin-bottom: 15px; color: var(--primary-dark); display: flex; align-items: center; gap: 10px; }
        .btn { border: none; padding: 15px; border-radius: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 1rem; width: 100%; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }

        /* ç™»å…¥é  */
        #screen-login { height: 100vh; display: flex; flex-direction: column; justify-content: center; text-align: center; background: white; }
        .login-logo { font-size: 4rem; margin-bottom: 10px; }

        /* é ‚éƒ¨ç‹€æ…‹åˆ— */
        .top-status { padding: 15px 20px; background: white; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 90; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .user-info { display: flex; align-items: center; gap: 8px; font-weight: bold; color: var(--primary-dark); }

        /* åº•éƒ¨å°è¦½ */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-height); background: white; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #eee; z-index: 1000; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: var(--text-sub); font-size: 0.75rem; cursor: pointer; opacity: 0.6; }
        .nav-item.active { color: var(--primary); opacity: 1; font-weight: bold; }
        .nav-item svg { width: 24px; height: 24px; margin-bottom: 4px; }

        /* æ ¸å¿ƒåŠŸèƒ½ï¼šåˆ†æçµæœå¡ç‰‡ */
        .res-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .res-item { background: #f8f9fa; padding: 12px; border-radius: 10px; border-left: 4px solid var(--primary); }
        .res-label { font-size: 0.75rem; color: var(--text-sub); }
        .res-val { font-size: 1.1rem; font-weight: bold; display: block; }
        .iddsi-box { grid-column: span 2; background: #e0f2f1; padding: 15px; border-radius: 10px; margin-top: 10px; }

        /* é†«ç™‚è²æ˜æ¨£å¼ */
        .disclaimer { font-size: 12px; color: var(--text-sub); background: #fff3e0; padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid var(--accent); }

        /* æ‹ç…§å€å¡Š */
        .upload-zone { border: 2px dashed #ccc; border-radius: var(--radius); height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fafafa; position: relative; overflow: hidden; margin-bottom: 15px; }
        .upload-zone input { position: absolute; inset: 0; opacity: 0; }
        .preview-img { width: 100%; height: 100%; object-fit: cover; display: none; }

        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-container { margin-top: 15px; }
        .progress-bar { background: #eee; height: 8px; border-radius: 4px; margin-bottom: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.8s ease; }

        /* æ­·å²åˆ—è¡¨ */
        .log-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #eee; }
        .log-meta h4 { font-size: 1rem; margin-bottom: 4px; }
        .log-meta p { font-size: 0.8rem; color: var(--text-sub); }

        /* è¼‰å…¥ä¸­é®ç½© */
        .loader { position: fixed; inset: 0; background: rgba(255,255,255,0.9); z-index: 2000; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .spinner { width: 45px; height: 45px; border: 5px solid #f3f3f3; border-top: 5px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="loading" class="loader">
        <div class="spinner"></div>
        <h3 style="margin-top: 20px; color: var(--primary);">AI ç‡Ÿé¤Šè¾¨è­˜ä¸­...</h3>
        <p style="color: #888; font-size: 0.9rem;">æ­£åœ¨åˆ†æå½±åƒè³ªåœ°èˆ‡æˆåˆ†</p>
    </div>

    <section id="screen-login" class="screen active">
        <div class="login-logo">ğŸ¥—</div>
        <h2 style="color: var(--primary-dark);">å±…å®¶æ™ºæ…§ç‡Ÿé¤Šç›£æ¸¬</h2>
        <p style="color: var(--text-sub); margin-bottom: 30px;">Prototype V2.0</p>
        <div style="padding: 0 40px;">
            <input type="text" placeholder="å¸³è™Ÿ" value="YuChen_Wu" style="width:100%; padding:15px; margin-bottom:10px; border:1px solid #ddd; border-radius:10px;">
            <input type="password" placeholder="å¯†ç¢¼" value="******" style="width:100%; padding:15px; margin-bottom:20px; border:1px solid #ddd; border-radius:10px;">
            <button class="btn btn-primary" onclick="app.navTo('home')">é€²å…¥ç³»çµ±</button>
        </div>
    </section>

    <div id="main-content" style="display: none;">
        
        <div class="top-status">
            <div class="user-info">ğŸ‘¤ <span id="user-display-name">å³å®¥è¾° (Yu-Chen)</span></div>
            <div style="font-size: 0.8rem; background: #e0f2f1; padding: 4px 8px; border-radius: 5px; color: var(--primary-dark);">å¤§ä¸‰è³‡ç®¡å°ˆé¡Œ</div>
        </div>

        <section id="screen-home" class="screen">
            <div class="section-title">ä»Šæ—¥æ¦‚æ³</div>
            <div class="card" style="background: linear-gradient(135deg, var(--primary) 0%, #4db6ac 100%); color: white;">
                <p style="font-size: 0.9rem; opacity: 0.9;">ä»Šæ—¥å·²æ”å–ç†±é‡</p>
                <h1 style="margin: 10px 0;">1,250 <span style="font-size: 1rem;">kcal</span></h1>
                <div class="progress-bar" style="background: rgba(255,255,255,0.3);"><div class="progress-fill" style="width: 65%; background: white;"></div></div>
                <p style="font-size: 0.8rem;">è·é›¢æ¯æ—¥å»ºè­°ç›®æ¨™é‚„å·® 650 kcal</p>
            </div>

            <div class="section-title">å¿«é€ŸåŠŸèƒ½</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <button class="card" style="text-align: center;" onclick="app.navTo('add')">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ“¸</div>
                    <b>æ–°å¢ç´€éŒ„</b>
                </button>
                <button class="card" style="text-align: center;" onclick="app.navTo('history')">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ“Š</div>
                    <b>æ­·å²çµ±è¨ˆ</b>
                </button>
            </div>
        </section>

        <section id="screen-add" class="screen">
            <div class="section-title">ğŸ“¸ æ‹ç…§ç´€éŒ„</div>
            <div class="card">
                <div class="upload-zone">
                    <input type="file" accept="image/*" onchange="app.handleFile(event)">
                    <div id="upload-hint">
                        <p style="font-size: 2.5rem;">ğŸ“·</p>
                        <p style="color: #888;">é»æ“Šæ‹æ”é¤é»ç…§ç‰‡</p>
                    </div>
                    <img id="preview" class="preview-img">
                </div>

                <div style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">é¤åˆ¥</label>
                    <select id="meal-type" style="width:100%; padding:12px; border-radius:10px; border:1px solid #ddd;">
                        <option>æ—©é¤</option>
                        <option selected>åˆé¤</option>
                        <option>æ™šé¤</option>
                        <option>é»å¿ƒ</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" onclick="app.analyze()">é€å‡º AI åˆ†æ</button>
            </div>
        </section>

        <section id="screen-result" class="screen">
            <div class="section-title">ğŸ¥— AI ç‡Ÿé¤Šä¼°ç®—çµæœ</div>
            
            <div class="disclaimer">
                âš ï¸ <b>è²æ˜ï¼š</b>æœ¬çµæœåƒ…ä¾›ä¸€èˆ¬å±…å®¶ç‡Ÿé¤Šç´€éŒ„åƒè€ƒï¼Œä¸å…·å‚™é†«ç™‚è¨ºæ–·åŠŸèƒ½ã€‚å¦‚æœ‰ç‰¹æ®Šç–¾ç—…ï¼Œè«‹éµå¾ªé†«å¸«æˆ–ç‡Ÿé¤Šå¸«ä¹‹é†«å›‘ã€‚
            </div>

            <div class="card">
                <h3 id="res-food-name" style="margin-bottom: 15px;">--</h3>
                <div class="res-grid">
                    <div class="res-item"><span class="res-label">ç†±é‡</span><b class="res-val" id="res-kcal">--</b><span class="res-label">kcal</span></div>
                    <div class="res-item"><span class="res-label">è›‹ç™½è³ª</span><b class="res-val" id="res-protein">--</b><span class="res-label">g</span></div>
                    <div class="res-item"><span class="res-label">è„‚è‚ª</span><b class="res-val" id="res-fat">--</b><span class="res-label">g</span></div>
                    <div class="res-item"><span class="res-label">ç¢³æ°´</span><b class="res-val" id="res-carbs">--</b><span class="res-label">g</span></div>
                    
                    <div class="iddsi-box">
                        <span class="res-label" style="color: var(--primary-dark); font-weight: bold;">IDDSI è³ªåœ°åˆ†ç´šåƒè€ƒ</span>
                        <b class="res-val" id="res-iddsi" style="color: var(--primary-dark); font-size: 1.4rem;">Level --</b>
                        <p style="font-size: 11px; margin-top: 5px; color: #555;">(æ ¹æ“šå½±åƒåˆ¤æ–·ï¼Œæ­¤é£Ÿç‰©å±¬æ–¼ã€Œç´°ç¢åŠæ¿•è»Ÿã€ç­‰ç´šï¼Œé©åˆæœ‰è¼•å¾®å’€åš¼éœ€æ±‚è€…)</p>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 20px; padding: 15px; background: #e1f5fe; border-radius: 10px;">
                    <b style="color: #0277bd;">ğŸ©º è‡¨åºŠæé†’ (åƒè€ƒç”¨)ï¼š</b>
                    <p id="res-advice" style="font-size: 0.9rem; color: #01579b; margin-top: 5px;"></p>
                </div>

                <button class="btn btn-primary" style="margin-top: 20px;" onclick="app.navTo('home')">å®Œæˆä¸¦è¿”å›</button>
            </div>
        </section>

        <section id="screen-history" class="screen">
            <div class="section-title">ğŸ“‹ é£²é£Ÿæ­·å²æ—¥èªŒ</div>
            <div class="card" style="padding: 0;">
                <div id="log-list">
                    </div>
            </div>
        </section>

        <section id="screen-profile" class="screen">
            <div class="section-title">ğŸ‘¤ å€‹äººå¥åº·æª”æ¡ˆ</div>
            <div class="card">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <div style="width: 60px; height: 60px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white;">å³</div>
                    <div>
                        <h3>å³å®¥è¾°</h3>
                        <p style="color: var(--text-sub); font-size: 0.9rem;">20 æ­² | åœ‹ç«‹æ±è¯å¤§å­¸</p>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="res-item" style="border-left-color: var(--secondary);"><span class="res-label">BMI æŒ‡æ•¸</span><b class="res-val">22.4</b></div>
                    <div class="res-item" style="border-left-color: var(--secondary);"><span class="res-label">åŸºç¤ä»£è¬ç‡</span><b class="res-val">1650</b></div>
                </div>
                
                <div style="margin-top: 20px;">
                    <label style="font-size: 0.8rem; color: #888;">ç›®å‰é—œæ³¨</label>
                    <div style="display:flex; gap: 5px; margin-top: 5px;">
                        <span style="background: #e3f2fd; color: #1565c0; padding: 4px 10px; border-radius: 5px; font-size: 0.8rem;">é«”é‡ç®¡ç†</span>
                        <span style="background: #fff3e0; color: #e65100; padding: 4px 10px; border-radius: 5px; font-size: 0.8rem;">å¥åº·é£²é£Ÿ</span>
                    </div>
                </div>
            </div>
            
            <button class="btn btn-outline" style="border-color: #eee; color: #888;">ç™»å‡ºç³»çµ±</button>
        </section>

        <nav class="bottom-nav">
            <div class="nav-item active" onclick="app.navTo('home', this)">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                é¦–é 
            </div>
            <div class="nav-item" onclick="app.navTo('add', this)">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5 5 5z"/></svg>
                æ‹ç…§
            </div>
            <div class="nav-item" onclick="app.navTo('history', this)">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M13 3H6c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V9l-7-6zm0 1.5L18.5 10H13V4.5zM6 20V5h5v7h7v8H6z"/></svg>
                æ—¥èªŒ
            </div>
            <div class="nav-item" onclick="app.navTo('profile', this)">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                æª”æ¡ˆ
            </div>
        </nav>
    </div>

    <script>
        const app = {
            history: [
                { name: 'é›è‚‰å …æœæ²™æ‹‰', type: 'æ—©é¤', kcal: 420, date: '2026-02-02 08:30' },
                { name: 'ç³™ç±³é£¯é…ç…é®­é­š', type: 'åˆé¤', kcal: 680, date: '2026-02-01 12:15' }
            ],

            navTo: function(screenId, navEl) {
                // ç™»å…¥é‚è¼¯ç‰¹ä¾‹
                if(screenId !== 'login') {
                    document.getElementById('screen-login').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                }

                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById('screen-' + screenId).classList.add('active');

                if(navEl) {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    navEl.classList.add('active');
                }
                
                if(screenId === 'history') this.renderHistory();
                window.scrollTo(0,0);
            },

            handleFile: function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (evt) => {
                        const preview = document.getElementById('preview');
                        preview.src = evt.target.result;
                        preview.style.display = 'block';
                        document.getElementById('upload-hint').style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            },

            analyze: function() {
                document.getElementById('loading').style.display = 'flex';
                
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    
                    // æ¨¡æ“¬å‡è³‡æ–™ç”Ÿæˆ
                    const results = [
                        { name: 'é›è…¿æ’ä¾¿ç•¶', kcal: 850, p: 35, f: 28, c: 95, iddsi: 7, adv: 'æ­¤é¤é»æ²¹è„‚å«é‡è¼ƒé«˜ï¼Œå»ºè­°ä¸‹ä¸€é¤å¢åŠ é’èœæ”å–é‡ã€‚' },
                        { name: 'ç‡•éº¥å„ªæ ¼ç¢—', kcal: 320, p: 15, f: 8, c: 45, iddsi: 4, adv: 'è³ªåœ°éå¸¸é©åˆæ¶ˆåŒ–ï¼Œç‡Ÿé¤Šæ¯”ä¾‹å‡è¡¡ï¼Œæ¨è–¦ä½œç‚ºæ—¥å¸¸é¤é»ã€‚' }
                    ];
                    const pick = results[Math.floor(Math.random() * results.length)];

                    document.getElementById('res-food-name').innerText = pick.name;
                    document.getElementById('res-kcal').innerText = pick.kcal;
                    document.getElementById('res-protein').innerText = pick.p;
                    document.getElementById('res-fat').innerText = pick.f;
                    document.getElementById('res-carbs').innerText = pick.c;
                    document.getElementById('res-iddsi').innerText = "Level " + pick.iddsi;
                    document.getElementById('res-advice').innerText = pick.adv;

                    // å­˜å…¥æ­·å²
                    this.history.unshift({
                        name: pick.name,
                        type: document.getElementById('meal-type').value,
                        kcal: pick.kcal,
                        date: new Date().toLocaleString()
                    });

                    this.navTo('result');
                }, 2000);
            },

            renderHistory: function() {
                const list = document.getElementById('log-list');
                list.innerHTML = this.history.map(item => `
                    <div class="log-item">
                        <div class="log-meta">
                            <h4>${item.name}</h4>
                            <p>${item.date} â€¢ ${item.type}</p>
                        </div>
                        <div style="font-weight: bold; color: var(--primary);">${item.kcal} kcal</div>
                    </div>
                `).join('');
            }
        };
    </script>
</body>
</html>
