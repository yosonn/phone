<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NutriAI Mobile - æ™ºæ…§ç‡Ÿé¤Šè¼”åŠ©</title>
    <style>
        :root {
            --primary: #009688;
            --primary-dark: #00796b;
            --secondary: #2196f3;
            --accent: #ff9800;
            --danger: #f44336;
            --success: #4caf50;
            --bg: #f8f9fa;
            --surface: #ffffff;
            --text-main: #2d3436;
            --text-sub: #636e72;
            --shadow: 0 2px 10px rgba(0,0,0,0.05);
            --radius: 12px;
            --nav-height: 65px;
        }

        /* åŸºç¤è¨­å®š */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, system-ui, sans-serif; }
        body { 
            background-color: var(--bg); 
            color: var(--text-main); 
            padding-bottom: calc(var(--nav-height) + 20px); 
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* é ‚éƒ¨æ¨™é¡Œåˆ— */
        .top-bar {
            position: sticky; top: 0; background: var(--surface);
            padding: 15px 20px; display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05); z-index: 100;
        }
        .app-title { font-size: 1.2rem; font-weight: 800; color: var(--primary); display: flex; align-items: center; gap: 6px; }
        .patient-badge { font-size: 0.75rem; background: #e0f2f1; color: var(--primary-dark); padding: 4px 10px; border-radius: 20px; font-weight: 600; }

        /* å®¹å™¨èˆ‡è¦–åœ– */
        .container { padding: 15px; width: 100%; }
        .view { display: none; animation: slideUp 0.3s ease-out; }
        .view.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* åº•éƒ¨å°è¦½åˆ— */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-height);
            background: var(--surface); display: flex; justify-content: space-around;
            align-items: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); border-top: 1px solid #eee; z-index: 1000;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: var(--text-sub); font-size: 0.7rem; cursor: pointer; transition: 0.2s; }
        .nav-item svg { width: 24px; height: 24px; margin-bottom: 3px; }
        .nav-item.active { color: var(--primary); font-weight: bold; }

        /* å¡ç‰‡èˆ‡å…ƒä»¶ */
        .card { background: var(--surface); border-radius: var(--radius); padding: 18px; margin-bottom: 15px; box-shadow: var(--shadow); }
        .section-title { font-size: 1.1rem; font-weight: bold; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .btn { border: none; padding: 14px; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 1rem; width: 100%; transition: 0.2s; }
        .btn:active { transform: scale(0.98); opacity: 0.9; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: #e0f2f1; color: var(--primary-dark); }
        .btn-outline { background: transparent; border: 1px solid #ddd; color: var(--text-sub); }

        /* æ‹ç…§å€å¡Š */
        .camera-box {
            border: 2px dashed #ddd; border-radius: var(--radius); height: 200px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: #fafafa; position: relative; overflow: hidden;
        }
        .camera-box input { position: absolute; opacity: 0; width: 100%; height: 100%; }
        .preview-img { width: 100%; height: 100%; object-fit: cover; display: none; }

        /* ç‡Ÿé¤Šæ¢ */
        .nutri-row { margin-bottom: 12px; }
        .nutri-label { display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 4px; }
        .bar-bg { background: #eee; height: 8px; border-radius: 4px; overflow: hidden; }
        .bar-fill { height: 100%; background: var(--primary); width: 0; transition: width 0.6s cubic-bezier(0.1, 0.7, 1.0, 0.1); }

        /* æ¨™ç±¤ */
        .tag-wrap { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
        .tag { font-size: 0.75rem; padding: 4px 10px; border-radius: 6px; background: #f0f0f0; color: #555; }
        .tag.blue { background: #e3f2fd; color: #1565c0; }
        .tag.red { background: #ffebee; color: #c62828; }

        /* æ­·å²ç´€éŒ„åˆ—è¡¨ */
        .log-list { list-style: none; }
        .log-card { display: flex; align-items: center; gap: 12px; padding: 12px; border-bottom: 1px solid #f0f0f0; }
        .log-icon { width: 44px; height: 44px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0; }

        /* è¼‰å…¥é®ç½© */
        .overlay { position: fixed; inset: 0; background: rgba(255,255,255,0.9); z-index: 2000; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* æç¤ºæ¡† */
        .info-box { padding: 12px; border-radius: 8px; font-size: 0.9rem; margin-top: 10px; border-left: 4px solid var(--primary); background: #f0fdfa; }
        .info-box.warn { border-color: var(--accent); background: #fffbeb; }
        .info-box.danger { border-color: var(--danger); background: #fef2f2; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="app-title">ğŸ¥— NutriAI</div>
        <div class="patient-badge" id="header-patient-name">ç—…äººè¼‰å…¥ä¸­...</div>
    </div>

    <div class="container">
        
        <div id="view-home" class="view active">
            <div class="section-title">ä»Šæ—¥æ¦‚æ³</div>
            <div class="card" style="background: linear-gradient(135deg, var(--primary) 0%, #4db6ac 100%); color: white;">
                <p style="opacity: 0.9; font-size: 0.9rem;">æ­¡è¿å›ä¾†ï¼Œç®¡ç†å“¡</p>
                <h2 style="margin: 5px 0;" id="home-greeting">è¼‰å…¥ä¸­...</h2>
                <p style="font-size: 0.8rem; margin-top: 10px;">ç›®å‰ç‹€æ…‹ï¼šé£²é£Ÿç´€éŒ„æ”¶é›†ä¸­</p>
            </div>
            
            <div class="section-title">å¸¸ç”¨åŠŸèƒ½</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div class="card" onclick="app.navTo('view-upload')" style="text-align: center; margin-bottom: 0;">
                    <div style="font-size: 2rem; margin-bottom: 5px;">ğŸ“¸</div>
                    <div style="font-size: 0.9rem; font-weight: bold;">æ‹ç…§åˆ†æ</div>
                </div>
                <div class="card" onclick="app.navTo('view-advice')" style="text-align: center; margin-bottom: 0;">
                    <div style="font-size: 2rem; margin-bottom: 5px;">ğŸ’¡</div>
                    <div style="font-size: 0.9rem; font-weight: bold;">é£²é£Ÿå»ºè­°</div>
                </div>
            </div>
        </div>

        <div id="view-upload" class="view">
            <div class="section-title">å½±åƒè¾¨è­˜åˆ†æ</div>
            <div class="card">
                <div class="camera-box" id="drop-zone">
                    <input type="file" accept="image/*" onchange="app.handleFileSelect(event)">
                    <div id="upload-placeholder">
                        <div style="font-size: 3rem;">ğŸ“·</div>
                        <p style="color: #888;">é»æ“Šé–‹å•Ÿç›¸æ©Ÿ</p>
                    </div>
                    <img id="preview" class="preview-img">
                </div>
                <button class="btn btn-primary" style="margin-top: 15px;" onclick="app.startAnalysis()">é–‹å§‹ VLM æ™ºèƒ½è­˜åˆ¥</button>
            </div>

            <div id="result-section" style="display: none;">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <h2 id="res-food-name">--</h2>
                        <span id="res-badge" style="font-size: 0.8rem; font-weight: bold;">--</span>
                    </div>
                    <p style="color: var(--text-sub); font-size: 0.8rem;">åˆ†æä¿¡å¿ƒåº¦: <span id="res-confidence">--</span></p>
                    <div id="res-ingredients" class="tag-wrap"></div>

                    <div style="margin-top: 20px;" id="nutrition-chart"></div>

                    <div id="res-advice-box" class="info-box">
                        <ul id="res-advices" style="padding-left: 15px;"></ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-profile" class="view">
            <div class="section-title">å€‹äººé›»å­ç—…æ­·</div>
            <div class="card" style="border-top: 4px solid var(--primary);">
                <div style="display: flex; justify-content: space-between;">
                    <h2 id="p-name">--</h2>
                    <div style="text-align: right;"><small>BMI</small><br><b id="p-bmi" style="font-size: 1.2rem;">--</b></div>
                </div>
                <p id="p-details" style="color: var(--text-sub); font-size: 0.9rem; margin-bottom: 15px;">--</p>
                
                <div style="margin-bottom: 10px;">
                    <label style="font-size: 0.8rem; color: #888;">è‡¨åºŠè¨ºæ–·</label>
                    <div id="p-diseases" class="tag-wrap"></div>
                </div>
                <div style="margin-bottom: 10px;">
                    <label style="font-size: 0.8rem; color: #888;">ç•¶å‰è—¥ç‰©</label>
                    <div id="p-meds" class="tag-wrap"></div>
                </div>
                <div>
                    <label style="font-size: 0.8rem; color: #888;">éæ•ç´€éŒ„</label>
                    <div id="p-allergies" class="tag-wrap"></div>
                </div>
            </div>

            <div class="card">
                <label style="font-size: 0.8rem; color: #888;">å¥åº·ç›®æ¨™</label>
                <p id="p-goal" style="font-weight: bold; color: var(--primary-dark); margin-top: 5px;">--</p>
            </div>

            <button class="btn btn-secondary" onclick="app.switchPatient()">åˆ‡æ›æ¨¡æ“¬ç—…äºº (Demo æ¸¬è©¦)</button>
        </div>

        <div id="view-log" class="view">
            <div class="section-title">é£²é£Ÿæ—¥èªŒåˆ—è¡¨</div>
            <div class="card" style="padding: 5px;" id="log-list-container">
                <div id="log-list"></div>
            </div>
            <button class="btn btn-outline" style="margin-top: 15px;" onclick="localStorage.removeItem('vlm_history'); app.loadLog();">æ¸…é™¤æ­·å²ç´€éŒ„</button>
        </div>

        <div id="view-advice" class="view">
            <div class="section-title">å°ˆæ¥­é£²é£ŸæŒ‡å°</div>
            <div class="card" style="background: #e1f5fe; border-left: 5px solid var(--secondary);">
                <h4 style="color: #0277bd;">é‡å° <span id="advice-patient-name">--</span> çš„å»ºè­°</h4>
            </div>
            <div class="card">
                <h4 style="color: var(--danger);">ğŸš« æ‡‰é¿å… / é™åˆ¶</h4>
                <ul id="advice-avoid" style="margin: 10px 0 0 20px; font-size: 0.95rem; color: #444;"></ul>
            </div>
            <div class="card">
                <h4 style="color: var(--success);">âœ… å»ºè­°æ”å–</h4>
                <ul id="advice-recommend" style="margin: 10px 0 0 20px; font-size: 0.95rem; color: #444;"></ul>
            </div>
        </div>

    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="app.navTo('view-home', this)">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            é¦–é 
        </div>
        <div class="nav-item" onclick="app.navTo('view-upload', this)">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5 5 5z"/></svg>
            æ‹ç…§åˆ†æ
        </div>
        <div class="nav-item" onclick="app.navTo('view-profile', this)">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            ç—…æ­·
        </div>
        <div class="nav-item" onclick="app.navTo('view-log', this)">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M13 3H6c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V9l-7-6zm0 1.5L18.5 10H13V4.5zM6 20V5h5v7h7v8H6z"/></svg>
            æ—¥èªŒ
        </div>
    </nav>

    <div id="loading" class="overlay">
        <div class="spinner"></div>
        <h3 style="margin-top: 15px;">VLM å½±åƒè™•ç†ä¸­...</h3>
        <p id="loading-text" style="color: #666; font-size: 0.8rem;">æ­£åœ¨è­˜åˆ¥é£Ÿç‰©æˆåˆ†èˆ‡ç‡Ÿé¤Šåƒ¹å€¼</p>
    </div>

    <script>
        /**
         * NutriAI Mobile - é‚è¼¯æ§åˆ¶ (ä¿æŒèˆ‡åŸç‰ˆç›¸åŒé‚è¼¯)
         */

        const PATIENTS = [
            {
                name: "ç‹å°æ˜",
                age: 56, gender: "ç”·", height: 172, weight: 78,
                diseases: ["ç¬¬2å‹ç³–å°¿ç—…", "é«˜è¡€å£“"],
                meds: ["Metformin", "Amlodipine"],
                allergies: ["ç„¡"],
                goal: "åš´æ ¼æ§ç³–ã€æ¸›é‡",
                advice: {
                    avoid: ["å«ç³–é£²æ–™ (å…¨ç³–çå¥¶ã€å¯æ¨‚)", "é«˜GIæ¾±ç²‰ (ç™½åå¸ã€ç³¯ç±³)", "é«˜éˆ‰åŠ å·¥å“ (é¦™è…¸ã€ç½é ­)"],
                    recommend: ["é«˜çº–è”¬èœ (åœ°ç“œè‘‰ã€èŠ±æ¤°èœ)", "å„ªè³ªè›‹ç™½ (é›èƒ¸è‚‰ã€è±†è…)", "ä½GIå…¨ç©€ (ç³™ç±³ã€ç‡•éº¥)"]
                },
                conditions: { dm: true, htn: true, ckd: false }
            },
            {
                name: "æ—ç¾ç²",
                age: 68, gender: "å¥³", height: 155, weight: 52,
                diseases: ["æ…¢æ€§è…è‡Ÿç—… (CKD)", "ç—›é¢¨"],
                meds: ["åˆ©å°¿åŠ‘", "é™å°¿é…¸è—¥"],
                allergies: ["æµ·é®®"],
                goal: "ä½éˆ‰ã€ä½é‰€ã€ä½ç£·",
                advice: {
                    avoid: ["é«˜é‰€æ°´æœ (é¦™è•‰ã€å¥‡ç•°æœ)", "å…§è‡Ÿé¡ã€é«˜æ¹¯", "å …æœèˆ‡å…¨ç©€é¡ (å«ç£·é«˜)"],
                    recommend: ["ä½æ°®æ¾±ç²‰ (å†¬ç²‰ã€ç±³ç²‰)", "å·ç‡™è”¬èœ (å»é‰€)", "è›‹ç™½ (å„ªè³ªè›‹ç™½è³ª)"]
                },
                conditions: { dm: false, htn: true, ckd: true }
            }
        ];

        const FOOD_DB = {
            bento: { name: "å°å¼æ’éª¨ä¾¿ç•¶", calories: 850, carbs: 105, protein: 35, fat: 38, sodium: 1200, tags: ["æ²¹ç‚¸", "é«˜é¹½"] },
            salad: { name: "é›è‚‰å‡±è–©æ²™æ‹‰", calories: 350, carbs: 15, protein: 28, fat: 22, sodium: 600, tags: ["ç”Ÿé£Ÿ", "ä½å¡"] },
            noodle: { name: "ç´…ç‡’ç‰›è‚‰éºµ", calories: 750, carbs: 85, protein: 45, fat: 28, sodium: 2400, tags: ["æ¹¯å“", "é«˜é¹½"] },
            burger: { name: "èµ·å¸ç‰›è‚‰æ¼¢å ¡", calories: 680, carbs: 45, protein: 32, fat: 40, sodium: 1350, tags: ["åŠ å·¥è‚‰å“"] }
        };

        const app = {
            currentPatientIdx: 0,
            currentFile: null,

            init: function() {
                this.renderPatient();
                this.loadLog();
                this.navTo('view-home');
            },

            navTo: function(viewId, navEl) {
                // åˆ‡æ›è¦–åœ–
                document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
                document.getElementById(viewId).classList.add('active');
                
                // åˆ‡æ›å°è¦½åˆ—ç‹€æ…‹
                if(navEl) {
                    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                    navEl.classList.add('active');
                }

                window.scrollTo(0,0);
                if(viewId === 'view-log') this.loadLog();
                if(viewId === 'view-advice') this.renderAdvice();
            },

            switchPatient: function() {
                this.currentPatientIdx = (this.currentPatientIdx + 1) % PATIENTS.length;
                this.renderPatient();
                this.renderAdvice();
                alert(`å·²æˆåŠŸæ¨¡æ“¬åˆ‡æ›è‡³ç—…äººï¼š${PATIENTS[this.currentPatientIdx].name}`);
            },

            renderPatient: function() {
                const p = PATIENTS[this.currentPatientIdx];
                const bmi = (p.weight / ((p.height/100) ** 2)).toFixed(1);
                
                document.getElementById('header-patient-name').textContent = p.name;
                document.getElementById('home-greeting').textContent = `${p.name} å…ˆç”Ÿ/å¥³å£«`;
                
                document.getElementById('p-name').textContent = p.name;
                document.getElementById('p-details').textContent = `${p.age}æ­² / ${p.gender} / ${p.height}cm / ${p.weight}kg`;
                document.getElementById('p-bmi').textContent = bmi;
                document.getElementById('p-goal').textContent = p.goal;

                const makeTags = (arr, cls, id) => {
                    document.getElementById(id).innerHTML = arr.map(t => `<span class="tag ${cls}">${t}</span>`).join('');
                };
                makeTags(p.diseases, 'blue', 'p-diseases');
                makeTags(p.meds, 'red', 'p-meds');
                makeTags(p.allergies, 'red', 'p-allergies');
            },

            renderAdvice: function() {
                const p = PATIENTS[this.currentPatientIdx];
                document.getElementById('advice-patient-name').textContent = p.name;
                document.getElementById('advice-avoid').innerHTML = p.advice.avoid.map(t => `<li>${t}</li>`).join('');
                document.getElementById('advice-recommend').innerHTML = p.advice.recommend.map(t => `<li>${t}</li>`).join('');
            },

            handleFileSelect: function(e) {
                const file = e.target.files[0];
                if (file) {
                    this.currentFile = file;
                    const reader = new FileReader();
                    reader.onload = (evt) => {
                        document.getElementById('preview').src = evt.target.result;
                        document.getElementById('preview').style.display = 'block';
                        document.getElementById('upload-placeholder').style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            },

            startAnalysis: function() {
                document.getElementById('loading').style.display = 'flex';
                setTimeout(() => {
                    const keys = Object.keys(FOOD_DB);
                    const key = this.currentFile ? keys[this.currentFile.name.length % keys.length] : keys[Math.floor(Math.random() * keys.length)];
                    this.showResult(FOOD_DB[key]);
                    document.getElementById('loading').style.display = 'none';
                }, 2000);
            },

            showResult: function(food) {
                const p = PATIENTS[this.currentPatientIdx];
                document.getElementById('res-food-name').textContent = food.name;
                document.getElementById('res-confidence').textContent = (85 + Math.floor(Math.random()*14)) + "%";
                document.getElementById('res-ingredients').innerHTML = food.tags.map(t => `<span class="tag">${t}</span>`).join('');
                
                const badge = document.getElementById('res-badge');
                const adviceBox = document.getElementById('res-advice-box');
                const advices = document.getElementById('res-advices');
                let adviceList = [];
                let status = "safe";

                if (p.conditions.ckd && food.sodium > 800) {
                    status = "danger";
                    adviceList.push("âš ï¸ é«˜éˆ‰è­¦å‘Šï¼šè…è‡Ÿè² æ“”éé‡ï¼Œå»ºè­°é¿å…é£Ÿç”¨");
                } else if (p.conditions.dm && food.carbs > 80) {
                    status = "warn";
                    adviceList.push("âœ‹ æ§ç³–æé†’ï¼šç¢³æ°´å«é‡æ¥µé«˜ï¼Œè«‹æ¸›é‡ä¸¦æ­é…è”¬èœ");
                } else {
                    adviceList.push("âœ… æ•¸å€¼æ­£å¸¸ï¼šç¬¦åˆæ‚¨ç›®å‰çš„é£²é£Ÿå»ºè­°");
                }

                badge.textContent = status === "danger" ? "ä¸å»ºè­°" : (status === "warn" ? "è«‹é©é‡" : "æ¨è–¦é£Ÿç”¨");
                badge.style.color = status === "safe" ? "var(--success)" : (status === "danger" ? "var(--danger)" : "var(--accent)");
                adviceBox.className = `info-box ${status}`;
                advices.innerHTML = adviceList.map(t => `<li>${t}</li>`).join('');

                const makeBar = (label, val, max, unit) => `
                    <div class="nutri-row">
                        <div class="nutri-label"><span>${label}</span><span>${val} ${unit}</span></div>
                        <div class="bar-bg"><div class="bar-fill" id="bar-${label}" data-val="${(val/max)*100}"></div></div>
                    </div>`;
                
                document.getElementById('nutrition-chart').innerHTML = 
                    makeBar("ç†±é‡", food.calories, 1000, "kcal") +
                    makeBar("ç¢³æ°´", food.carbs, 100, "g") +
                    makeBar("è›‹ç™½è³ª", food.protein, 50, "g") +
                    makeBar("éˆ‰", food.sodium, 2000, "mg");

                setTimeout(() => {
                    document.querySelectorAll('.bar-fill').forEach(bar => {
                        bar.style.width = bar.getAttribute('data-val') + '%';
                        if(parseFloat(bar.getAttribute('data-val')) > 80) bar.style.backgroundColor = 'var(--danger)';
                    });
                }, 100);

                document.getElementById('result-section').style.display = 'block';
                this.saveLog(food, p.name, status);
            },

            saveLog: function(food, pName, status) {
                const record = {
                    date: new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    food: food.name, patient: pName, cals: food.calories, status: status
                };
                const logs = JSON.parse(localStorage.getItem('vlm_history') || '[]');
                logs.unshift(record);
                localStorage.setItem('vlm_history', JSON.stringify(logs));
            },

            loadLog: function() {
                const logs = JSON.parse(localStorage.getItem('vlm_history') || '[]');
                const container = document.getElementById('log-list');
                if (logs.length === 0) {
                    container.innerHTML = '<p style="text-align:center; padding:30px; color:#999;">å°šç„¡é£²é£Ÿç´€éŒ„</p>';
                    return;
                }
                container.innerHTML = logs.map(l => {
                    const icon = l.status === 'danger' ? 'âŒ' : (l.status === 'warn' ? 'âš ï¸' : 'âœ…');
                    const bg = l.status === 'danger' ? '#ffebee' : (l.status === 'warn' ? '#fff3e0' : '#e8f5e9');
                    return `
                        <div class="log-card">
                            <div class="log-icon" style="background:${bg}">${icon}</div>
                            <div style="flex: 1;">
                                <div style="font-weight:bold; font-size:0.95rem;">${l.food}</div>
                                <div style="font-size:0.75rem; color:#888;">${l.date} â€¢ ${l.patient}</div>
                            </div>
                            <div style="font-weight:bold; font-size:0.9rem;">${l.cals} kcal</div>
                        </div>`;
                }).join('');
            }
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
