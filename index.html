<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å±…å®¶æ™ºæ…§ç‡Ÿé¤Šç›£æ¸¬ç³»çµ± - Prototype</title>
    <style>
        /* --- åŸºç¤è¨­å®šèˆ‡è®Šæ•¸ --- */
        :root {
            --primary-color: #2A7ADE; /* é†«ç™‚è— */
            --bg-color: #F8FAFC;
            --card-bg: #FFFFFF;
            --text-main: #334155;
            --text-muted: #64748B;
            --accent-color: #10B981; /* æˆåŠŸç¶  */
            --warning-color: #F59E0B;
            --border-radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #E2E8F0; /* æ¨¡æ“¬æ¡Œé¢ä¸Šç€è¦½æ™‚çš„èƒŒæ™¯ */
            margin: 0;
            display: flex;
            justify-content: center;
            color: var(--text-main);
            line-height: 1.6;
        }

        /* --- æ‰‹æ©Ÿå®¹å™¨æ¨¡æ“¬ --- */
        #mobile-container {
            width: 100%;
            max-width: 480px;
            min-height: 100vh;
            background-color: var(--bg-color);
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- é é¢åˆ‡æ›é‚è¼¯ --- */
        .screen {
            display: none;
            flex-direction: column;
            padding: 20px;
            animation: fadeIn 0.3s ease;
            flex-grow: 1;
        }
        .screen.active { display: flex; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- é€šç”¨å…ƒä»¶ --- */
        h1, h2, h3 { color: var(--primary-color); margin-top: 0; }
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 16px;
            border-radius: var(--border-radius);
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: opacity 0.2s;
            margin-bottom: 12px;
            width: 100%;
        }
        .btn:active { opacity: 0.8; }
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-muted); }
        input, select, textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #CBD5E1;
            border-radius: var(--border-radius);
            font-size: 16px;
        }

        /* --- 1. ç™»å…¥é  --- */
        #login-screen { justify-content: center; text-align: center; }
        .logo-placeholder {
            width: 80px; height: 80px; background: var(--primary-color);
            border-radius: 20px; margin: 0 auto 20px;
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 40px;
        }

        /* --- 2. é¦–é  --- */
        .dashboard-card {
            background: var(--card-bg);
            padding: 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 24px;
            text-align: center;
        }
        .date-text { font-size: 1.2rem; font-weight: bold; margin-bottom: 8px; }

        /* --- 3. æ–°å¢ç´€éŒ„é  --- */
        .upload-box {
            border: 2px dashed #CBD5E1;
            padding: 40px 20px;
            text-align: center;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            cursor: pointer;
            background: #fff;
        }
        .loading-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(255,255,255,0.9);
            display: none; flex-direction: column;
            align-items: center; justify-content: center; z-index: 100;
        }
        .spinner {
            width: 50px; height: 50px; border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- 4. åˆ†æçµæœé  --- */
        .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .result-card {
            background: white; padding: 15px; border-radius: 12px;
            box-shadow: var(--shadow); border-left: 4px solid var(--primary-color);
        }
        .result-card.full { grid-column: span 2; border-left: 4px solid var(--warning-color); }
        .val { font-size: 1.4rem; font-weight: bold; display: block; }
        .unit { font-size: 0.8rem; color: var(--text-muted); }
        .disclaimer {
            font-size: 13px; color: var(--text-muted);
            background: #F1F5F9; padding: 15px; border-radius: 8px; margin-bottom: 20px;
        }

        /* --- 5. æ­·å²ç´€éŒ„é  --- */
        .history-list { list-style: none; padding: 0; }
        .history-item {
            background: white; padding: 16px; border-radius: 12px;
            margin-bottom: 12px; box-shadow: var(--shadow);
            display: flex; justify-content: space-between; align-items: center;
        }
        .history-info h4 { margin: 0; font-size: 16px; }
        .history-info p { margin: 0; font-size: 14px; color: var(--text-muted); }
    </style>
</head>
<body>

    <div id="mobile-container">
        
        <div id="loading-overlay" class="loading-overlay">
            <div class="spinner"></div>
            <p style="margin-top: 15px; font-weight: bold;">å½±åƒè¾¨è­˜åˆ†æä¸­...</p>
        </div>

        <section id="login-screen" class="screen active">
            <div class="logo-placeholder">ğŸ¥—</div>
            <h1>å±…å®¶æ™ºæ…§ç‡Ÿé¤Šç›£æ¸¬</h1>
            <p style="color: var(--text-muted); margin-bottom: 30px;">åŸå‹å±•ç¤ºç‰ˆæœ¬</p>
            
            <div class="input-group">
                <input type="text" placeholder="è«‹è¼¸å…¥å¸³è™Ÿ" value="demo_user">
            </div>
            <div class="input-group">
                <input type="password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" value="******">
            </div>
            <button class="btn" onclick="navigateTo('dashboard-screen')">ç™»å…¥ç³»çµ±</button>
        </section>

        <section id="dashboard-screen" class="screen">
            <h3>æ‚¨å¥½ï¼Œä»Šå¤©éå¾—å¦‚ä½•ï¼Ÿ</h3>
            <div class="dashboard-card">
                <div class="date-text" id="current-date">2026å¹´2æœˆ2æ—¥</div>
                <p id="dashboard-status">ä»Šæ—¥å°šæœªæ–°å¢é£²é£Ÿç´€éŒ„</p>
            </div>
            
            <button class="btn" onclick="navigateTo('add-meal-screen')">ï¼‹ æ–°å¢é£²é£Ÿç´€éŒ„</button>
            <button class="btn btn-outline" onclick="renderHistory(); navigateTo('history-screen')">ğŸ“‹ æŸ¥çœ‹æ­·å²ç´€éŒ„</button>
        </section>

        <section id="add-meal-screen" class="screen">
            <h3 onclick="navigateTo('dashboard-screen')" style="cursor: pointer;">â† è¿”å›é¦–é </h3>
            <h2>æ–°å¢é£²é£Ÿç´€éŒ„</h2>
            
            <label>æ‹ç…§æˆ–ä¸Šå‚³é¤é»ç…§ç‰‡</label>
            <div class="upload-box" onclick="document.getElementById('file-input').click()">
                <span id="upload-text">ğŸ“¸ é»æ“Šé–‹å•Ÿç›¸æ©Ÿ / ä¸Šå‚³</span>
                <input type="file" id="file-input" style="display:none" onchange="handleFile(this)">
            </div>

            <div class="input-group">
                <label>é¤åˆ¥</label>
                <select id="meal-type">
                    <option value="æ—©é¤">æ—©é¤</option>
                    <option value="åˆé¤">åˆé¤</option>
                    <option value="æ™šé¤">æ™šé¤</option>
                    <option value="é»å¿ƒ">é»å¿ƒ / å…¶ä»–</option>
                </select>
            </div>

            <div class="input-group">
                <label>å‚™è¨» (é¸å¡«)</label>
                <textarea id="meal-note" rows="3" placeholder="ä¾‹å¦‚ï¼šä»Šå¤©èƒƒå£ä¸éŒ¯"></textarea>
            </div>

            <button class="btn" onclick="simulateAnalysis()">é€å‡ºåˆ†æ</button>
        </section>

        <section id="analysis-screen" class="screen">
            <h2>å½±åƒåˆ†æçµæœ</h2>
            <div class="disclaimer">
                âš ï¸ <strong>è²æ˜ï¼š</strong>æ­¤ç‚ºç³»çµ±è‡ªå‹•ä¼°ç®—ä¹‹åƒè€ƒè³‡è¨Šï¼Œä¸¦éé†«ç™‚è¨ºæ–·ã€‚æ•¸å€¼å¯èƒ½éš¨çƒ¹é£ªæ–¹å¼æœ‰æ‰€èª¤å·®ã€‚
            </div>

            <div class="result-grid">
                <div class="result-card">
                    <label>ç†±é‡ä¼°ç®—</label>
                    <span class="val" id="res-kcal">--</span><span class="unit">kcal</span>
                </div>
                <div class="result-card">
                    <label>è›‹ç™½è³ª</label>
                    <span class="val" id="res-protein">--</span><span class="unit">g</span>
                </div>
                <div class="result-card">
                    <label>ç¢³æ°´åŒ–åˆç‰©</label>
                    <span class="val" id="res-carbs">--</span><span class="unit">g</span>
                </div>
                <div class="result-card">
                    <label>è„‚è‚ª</label>
                    <span class="val" id="res-fat">--</span><span class="unit">g</span>
                </div>
                <div class="result-card full">
                    <label>å»ºè­°è³ªåœ°ç­‰ç´š (IDDSI)</label>
                    <span class="val" id="res-iddsi">Level --</span>
                    <p style="font-size: 12px; color: var(--text-muted); margin: 5px 0 0 0;">
                        ä¾å½±åƒåˆ¤æ–·ï¼Œæ­¤é¤é»è³ªåœ°è¼ƒæ¥è¿‘ä¸Šè¿°ç­‰ç´šã€‚
                    </p>
                </div>
            </div>

            <div class="disclaimer" style="background: #E0F2FE;">
                ğŸ’¡ <strong>ç‡Ÿé¤Šæé†’ï¼š</strong>ç¶­æŒé£²é£Ÿå¤šæ¨£åŒ–æœ‰åŠ©æ–¼ç‡Ÿé¤Šå‡è¡¡ï¼Œå»ºè­°æ”å–è¶³å¤ æ°´åˆ†ã€‚
            </div>

            <button class="btn" onclick="saveAndFinish()">ç¢ºèªä¸¦è¿”å›é¦–é </button>
        </section>

        <section id="history-screen" class="screen">
            <h3 onclick="navigateTo('dashboard-screen')" style="cursor: pointer;">â† è¿”å›é¦–é </h3>
            <h2>æ­·å²ç´€éŒ„</h2>
            <ul class="history-list" id="history-list">
                </ul>
        </section>

    </div>

    <script>
        // --- æ¨¡æ“¬è³‡æ–™åº« ---
        let historyData = [
            { date: '2026-02-01', type: 'æ—©é¤', kcal: 450, iddsi: '7', note: 'ä¸€èˆ¬åå¸èˆ‡è›‹' },
            { date: '2026-02-01', type: 'åˆé¤', kcal: 620, iddsi: '6', note: 'è»Ÿè³ªé›è‚‰éºµ' }
        ];

        let currentAnalysis = null;

        // --- è·¯ç”±åˆ‡æ› ---
        function navigateTo(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            window.scrollTo(0, 0);
        }

        // --- åˆå§‹åŒ–æ—¥æœŸ ---
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('zh-TW', {
            year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'
        });

        // --- æª”æ¡ˆä¸Šå‚³æ¨¡æ“¬ ---
        function handleFile(input) {
            if (input.files && input.files[0]) {
                document.getElementById('upload-text').innerText = "âœ… å·²é¸å–ç…§ç‰‡ï¼š" + input.files[0].name;
            }
        }

        // --- æ¨¡æ“¬åˆ†ææµç¨‹ ---
        function simulateAnalysis() {
            document.getElementById('loading-overlay').style.display = 'flex';
            
            // æ¨¡æ“¬ 2 ç§’çš„ AI è¾¨è­˜å»¶é²
            setTimeout(() => {
                document.getElementById('loading-overlay').style.display = 'none';
                
                // ç”¢ç”Ÿéš¨æ©Ÿæ¨¡æ“¬æ•¸æ“š
                currentAnalysis = {
                    date: new Date().toLocaleDateString('en-CA'), // YYYY-MM-DD
                    type: document.getElementById('meal-type').value,
                    kcal: Math.floor(Math.random() * (700 - 300) + 300),
                    protein: Math.floor(Math.random() * (30 - 15) + 15),
                    carbs: Math.floor(Math.random() * (80 - 40) + 40),
                    fat: Math.floor(Math.random() * (25 - 10) + 10),
                    iddsi: Math.floor(Math.random() * 4 + 4), // æ¨¡æ“¬ Level 4~7
                    note: document.getElementById('meal-note').value
                };

                // å¡«å…¥åˆ†æçµæœé 
                document.getElementById('res-kcal').innerText = currentAnalysis.kcal;
                document.getElementById('res-protein').innerText = currentAnalysis.protein;
                document.getElementById('res-carbs').innerText = currentAnalysis.carbs;
                document.getElementById('res-fat').innerText = currentAnalysis.fat;
                document.getElementById('res-iddsi').innerText = "Level " + currentAnalysis.iddsi;

                navigateTo('analysis-screen');
            }, 2000);
        }

        // --- å„²å­˜ä¸¦è¿”å› ---
        function saveAndFinish() {
            historyData.unshift(currentAnalysis); // æ–°å¢åˆ°åˆ—è¡¨æœ€å‰æ–¹
            document.getElementById('dashboard-status').innerText = `ä»Šæ—¥å·²è¨˜éŒ„ ${currentAnalysis.type} (${currentAnalysis.kcal} kcal)`;
            
            // æ¸…é™¤è¼¸å…¥æ¬„
            document.getElementById('upload-text').innerText = "ğŸ“¸ é»æ“Šé–‹å•Ÿç›¸æ©Ÿ / ä¸Šå‚³";
            document.getElementById('meal-note').value = "";
            
            navigateTo('dashboard-screen');
        }

        // --- æ¸²æŸ“æ­·å²ç´€éŒ„ ---
        function renderHistory() {
            const list = document.getElementById('history-list');
            list.innerHTML = '';
            
            historyData.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'history-item';
                li.onclick = () => alert(`è©³ç´°å‚™è¨»ï¼š${item.note || 'ç„¡'}`);
                li.innerHTML = `
                    <div class="history-info">
                        <h4>${item.date} ${item.type}</h4>
                        <p>ç†±é‡: ${item.kcal} kcal | è³ªåœ°: Level ${item.iddsi}</p>
                    </div>
                    <div style="color: var(--primary-color)">â¯</div>
                `;
                list.appendChild(li);
            });
        }
    </script>
</body>
</html>