<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriAI Web - é†«å­¸ç´šç‡Ÿé¤Šç›£æ¸¬ç³»çµ±</title>
    <style>
        :root {
            --primary: #00796b;
            --primary-light: #e0f2f1;
            --secondary: #2196f3;
            --accent: #ff9800;
            --danger: #d32f2f;
            --bg: #f4f7f6;
            --sidebar-width: 240px;
            --radius: 12px;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; }
        body { background-color: var(--bg); display: flex; min-height: 100vh; color: #333; }

        /* --- å´é‚Šå°è¦½åˆ— (Responsive Sidebar) --- */
        .sidebar {
            width: var(--sidebar-width);
            background: #fff;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 30px 20px;
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--primary);
            border-bottom: 1px solid #eee;
        }

        .nav-menu { list-style: none; padding: 20px 0; flex-grow: 1; }
        .nav-item {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            color: #666;
            font-weight: 500;
            transition: 0.2s;
        }
        .nav-item:hover, .nav-item.active {
            background: var(--primary-light);
            color: var(--primary);
            border-right: 4px solid var(--primary);
        }

        /* --- ä¸»è¦å…§å®¹å€ --- */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 30px;
            max-width: 1000px;
        }

        .screen { display: none; animation: fadeIn 0.4s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- UI å…ƒä»¶ --- */
        .card { background: #fff; border-radius: var(--radius); padding: 20px; margin-bottom: 25px; box-shadow: var(--shadow); }
        .section-title { margin-bottom: 20px; color: var(--primary); display: flex; align-items: center; gap: 8px; }
        
        /* éŸ¿æ‡‰å¼ Grid */
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

        /* é£Ÿè­œå¡ç‰‡ */
        .recipe-card {
            background: linear-gradient(to right, #ffffff, #f9f9f9);
            border-left: 5px solid var(--secondary);
            display: flex; gap: 15px; align-items: center; padding: 15px;
        }
        .recipe-tag { font-size: 0.75rem; background: var(--secondary); color: white; padding: 2px 8px; border-radius: 4px; }

        /* æ…¢æ€§ç—…æ•¸æ“šæŒ‡æ¨™ */
        .metric-badge {
            padding: 15px; border-radius: 10px; text-align: center;
            background: #f8f9fa; border: 1px solid #eee;
        }
        .metric-val { font-size: 1.5rem; font-weight: bold; color: var(--primary); display: block; }
        .metric-label { font-size: 0.8rem; color: #888; }

        /* æ‹ç…§é è¦½èˆ‡åˆ†æ */
        .upload-box {
            border: 2px dashed #ccc; border-radius: var(--radius); height: 250px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: #fafafa; position: relative; cursor: pointer;
        }
        .upload-box img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .btn {
            background: var(--primary); color: white; border: none; padding: 12px 24px;
            border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; margin-top: 15px;
        }

        /* æ­·å²ç´€éŒ„ (åŒ…å«åœ–ç‰‡) */
        .history-item {
            display: flex; gap: 15px; padding: 15px; border-bottom: 1px solid #eee; align-items: center;
        }
        .history-img { width: 70px; height: 70px; border-radius: 8px; object-fit: cover; background: #eee; }
        .history-info { flex: 1; }
        .history-status { font-size: 0.8rem; font-weight: bold; padding: 4px 8px; border-radius: 4px; }

        /* --- æ‰‹æ©Ÿç«¯é©é… --- */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); width: 200px; }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 15px; }
            .menu-toggle { display: block; position: fixed; bottom: 20px; right: 20px; background: var(--primary); color: white; padding: 15px; border-radius: 50%; z-index: 2000; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        }

        .menu-toggle { display: none; border: none; cursor: pointer; font-size: 1.2rem; }

        .loader {
            position: fixed; inset: 0; background: rgba(255,255,255,0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 5000;
        }
        .spinner { width: 40px; height: 40px; border: 4px solid #eee; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>

    <div id="loading" class="loader">
        <div class="spinner"></div>
        <p style="margin-top:15px; font-weight:bold;">AI å½±åƒåˆ†æèˆ‡é†«ç™‚æ¯”å°ä¸­...</p>
    </div>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">NutriAI Web</div>
        <ul class="nav-menu">
            <li class="nav-item active" onclick="app.navTo('home', this)">ğŸ  é¦–é å»ºè­°</li>
            <li class="nav-item" onclick="app.navTo('add', this)">ğŸ“¸ é£²é£Ÿè¾¨è­˜</li>
            <li class="nav-item" onclick="app.navTo('history', this)">ğŸ“œ é†«ç”¨æ—¥èªŒ</li>
            <li class="nav-item" onclick="app.navTo('profile', this)">ğŸ‘¤ æ…¢ç—…æ•¸æ“š</li>
        </ul>
        <div style="padding: 20px; font-size: 0.75rem; color: #aaa; border-top: 1px solid #eee;">
            æ‚£è€…ï¼šå³å®¥è¾°<br>ID: NDHU-IM-021
        </div>
    </nav>

    <main class="main-content">
        
        <section id="view-home" class="screen active">
            <h2 class="section-title">ä»Šæ—¥å»ºè­°é£Ÿè­œ</h2>
            <p style="color: #888; margin-bottom: 20px;">åŸºæ–¼æ‚¨çš„æ…¢æ€§ç—…æ•¸æ“šï¼Œç‚ºæ‚¨æŒ‘é¸ä½éˆ‰ã€ä½ GI çš„é¤é»ï¼š</p>
            
            <div class="grid-2">
                <div class="card recipe-card">
                    <div style="font-size: 2.5rem;">ğŸ¥£</div>
                    <div>
                        <span class="recipe-tag">æ—©é¤å»ºè­°</span>
                        <h4 style="margin: 5px 0;">ç„¡ç³–è±†æ¼¿èˆ‡ç‡•éº¥ç¢—</h4>
                        <p style="font-size: 0.85rem; color: #666;">å¯Œå«è†³é£Ÿçº–ç¶­ï¼Œæœ‰åŠ©æ–¼è¡€ç³–å¹³ç©©ã€‚</p>
                    </div>
                </div>
                <div class="card recipe-card" style="border-left-color: var(--primary);">
                    <div style="font-size: 2.5rem;">ğŸ¥—</div>
                    <div>
                        <span class="recipe-tag">åˆé¤å»ºè­°</span>
                        <h4 style="margin: 5px 0;">èˆ’è‚¥é›èƒ¸è‚‰è—œéº¥æ²™æ‹‰</h4>
                        <p style="font-size: 0.85rem; color: #666;">é«˜è›‹ç™½è³ªã€ä½é£½å’Œè„‚è‚ªï¼Œé©åˆè¡€å£“æ§åˆ¶ã€‚</p>
                    </div>
                </div>
            </div>

            <div class="card" style="background: #fff8e1; border: none;">
                <h4>ğŸ’¡ ç‡Ÿé¤Šå°æé†’</h4>
                <p style="font-size: 0.9rem; margin-top: 10px;">æ‚¨æ˜¨æ™šçš„è¡€å£“ç•¥é«˜ï¼Œä»Šæ—¥å»ºè­°æ¸›å°‘é¹½åˆ†æ”å–ï¼Œä¸¦è£œå…… 1500cc ä»¥ä¸Šçš„æ°´åˆ†ã€‚</p>
            </div>
        </section>

        <section id="view-add" class="screen">
            <h2 class="section-title">å½±åƒç‡Ÿé¤Šåˆ†æ</h2>
            <div class="card">
                <div class="upload-box" onclick="document.getElementById('img-input').click()">
                    <input type="file" id="img-input" hidden accept="image/*" onchange="app.previewImage(this)">
                    <div id="upload-placeholder">
                        <p style="font-size: 3rem;">ğŸ“¸</p>
                        <p>é»æ“Šä¸Šå‚³æˆ–æ‹æ”é¤é»ç…§ç‰‡</p>
                    </div>
                    <img id="img-preview" src="" style="display:none">
                </div>
                <button class="btn" onclick="app.runAnalysis()">é–‹å§‹ AI VLM è¾¨è­˜</button>
            </div>

            <div id="analysis-result" style="display: none;">
                <div class="card" style="border-top: 5px solid var(--primary);">
                    <h3 id="res-name">è¾¨è­˜çµæœ</h3>
                    <div class="grid-2" style="margin-top:15px;">
                        <div class="metric-badge"><span class="metric-label">ç†±é‡</span><span class="metric-val" id="res-kcal">0</span>kcal</div>
                        <div class="metric-badge"><span class="metric-label">è›‹ç™½è³ª</span><span class="metric-val" id="res-p">0</span>g</div>
                        <div class="metric-badge"><span class="metric-label">ç¢³æ°´</span><span class="metric-val" id="res-c">0</span>g</div>
                        <div class="metric-badge"><span class="metric-label">è³ªåœ° (IDDSI)</span><span class="metric-val" id="res-iddsi">L0</span></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-history" class="screen">
            <h2 class="section-title">é†«ç”¨é£²é£Ÿç´€éŒ„</h2>
            <div class="card" style="padding:0;">
                <div id="history-container">
                    </div>
            </div>
        </section>

        <section id="view-profile" class="screen">
            <h2 class="section-title">æ…¢æ€§ç—…å¥åº·æŒ‡æ¨™</h2>
            <div class="card">
                <div class="grid-2">
                    <div class="metric-badge">
                        <span class="metric-label">æ”¶ç¸®å£“ / èˆ’å¼µå£“</span>
                        <span class="metric-val">128 / 84</span>
                        <small style="color:var(--accent)">ç•¥é«˜æ–¼æ¨™æº–</small>
                    </div>
                    <div class="metric-badge">
                        <span class="metric-label">ç©ºè…¹è¡€ç³– (mg/dL)</span>
                        <span class="metric-val">98</span>
                        <small style="color:var(--success)">æ­£å¸¸</small>
                    </div>
                    <div class="metric-badge">
                        <span class="metric-label">ç³–åŒ–è¡€è‰²ç´  (HbA1c)</span>
                        <span class="metric-val">5.8%</span>
                        <small style="color:var(--success)">æ§åˆ¶è‰¯å¥½</small>
                    </div>
                    <div class="metric-badge">
                        <span class="metric-label">æœ€æ–°é«”é‡ (kg)</span>
                        <span class="metric-val">74.5</span>
                        <small>BMI: 24.2</small>
                    </div>
                </div>
            </div>

            <div class="card">
                <h4 style="margin-bottom:10px;">ğŸ‘¨â€âš•ï¸ é†«ç”Ÿå®åš€</h4>
                <p style="font-size: 0.95rem; line-height: 1.6; color: #555;">
                    ã€Œå³å…ˆç”Ÿæ‚¨å¥½ï¼Œæ ¹æ“šéå»ä¸€é€±çš„é£²é£Ÿç…§ç‰‡é¡¯ç¤ºï¼Œæ‚¨çš„æ™šé¤æ¾±ç²‰æ¯”ä¾‹è¼ƒé«˜ï¼Œå°è‡´éš”æ—¥æ™¨é–“è¡€å£“æœ‰æ³¢å‹•ã€‚å»ºè­°æ™šä¸Šå¤šè£œå……è‘‰èœé¡ï¼Œä¸¦ç¶­æŒæ¯æ—¥ 30 åˆ†é˜çš„å¿«èµ°ã€‚ã€
                </p>
            </div>
        </section>

    </main>

    <script>
        // --- æ ¸å¿ƒæ‡‰ç”¨é‚è¼¯ ---
        const app = {
            db: [
                { name: 'ç´…ç‡’ç‰›è‚‰éºµ', kcal: 720, p: 35, c: 85, iddsi: 'Level 7', status: 'ä¸å»ºè­°', img: 'https://images.unsplash.com/photo-1582878826629-29b7ad1cdc43?w=200&q=80', date: '2026-02-07' },
                { name: 'ç‡™é’èœèˆ‡é›è‚‰', kcal: 310, p: 28, c: 10, iddsi: 'Level 6', status: 'æ¨è–¦', img: 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=200&q=80', date: '2026-02-08' }
            ],

            navTo: function(screenId, el) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById('view-' + screenId).classList.add('active');
                
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                el.classList.add('active');

                if (screenId === 'history') this.renderHistory();
                if (window.innerWidth <= 768) toggleSidebar(); // æ‰‹æ©Ÿç‰ˆè‡ªå‹•æ”¶èµ·é¸å–®
            },

            previewImage: function(input) {
                if (input.files && input.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const preview = document.getElementById('img-preview');
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                        document.getElementById('upload-placeholder').style.display = 'none';
                    }
                    reader.readAsDataURL(input.files[0]);
                }
            },

            runAnalysis: function() {
                document.getElementById('loading').style.display = 'flex';
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('analysis-result').style.display = 'block';
                    
                    // æ¨¡æ“¬å‡æ•¸æ“š
                    const mock = { name: "ç…é®­é­šç©€ç‰©é£¯", kcal: 540, p: 32, c: 55, iddsi: "L7" };
                    document.getElementById('res-name').innerText = mock.name;
                    document.getElementById('res-kcal').innerText = mock.kcal;
                    document.getElementById('res-p').innerText = mock.p;
                    document.getElementById('res-c').innerText = mock.c;
                    document.getElementById('res-iddsi').innerText = mock.iddsi;

                    // åŠ å…¥æ­·å²ç´€éŒ„ (æ¨¡æ“¬)
                    const previewSrc = document.getElementById('img-preview').src;
                    this.db.unshift({
                        name: mock.name, kcal: mock.kcal, p: mock.p, c: mock.c, 
                        iddsi: mock.iddsi, status: 'è‰¯å¥½', img: previewSrc, date: 'ä»Šæ—¥'
                    });
                }, 2000);
            },

            renderHistory: function() {
                const container = document.getElementById('history-container');
                container.innerHTML = this.db.map(item => `
                    <div class="history-item">
                        <img src="${item.img}" class="history-img">
                        <div class="history-info">
                            <div style="display:flex; justify-content:space-between;">
                                <strong>${item.name}</strong>
                                <small style="color:#999;">${item.date}</small>
                            </div>
                            <p style="font-size:0.85rem; color:#666; margin:4px 0;">ç†±é‡: ${item.kcal} kcal | è›‹ç™½è³ª: ${item.p}g</p>
                            <span class="history-status" style="background:${item.status === 'æ¨è–¦' || item.status === 'è‰¯å¥½' ? '#e8f5e9; color:#2e7d32;' : '#ffebee; color:#c62828;'}">
                                ${item.status}
                            </span>
                        </div>
                    </div>
                `).join('');
            }
        };

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            app.renderHistory();
        };
    </script>
</body>
</html>
